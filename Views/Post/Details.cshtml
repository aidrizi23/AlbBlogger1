@* $1$ @using AlbBlogger1.Data #1# *@
@* $1$ @using Microsoft.AspNetCore.Identity #1# *@
@* $1$ @using Microsoft.AspNetCore.Mvc.TagHelpers #1# *@
@* $1$ @model PostDetailsViewModel #1# *@
@* $1$ @inject UserManager<ApplicationUser> UserManager #1# *@
@* $1$ #1# *@
@* $1$ #1# *@
@* $1$ @{ #1# *@
@* $1$     ViewData["Title"] = "Details"; #1# *@
@* $1$ } #1# *@
@* $1$ #1# *@
@* $1$ <div class="container mt-4"> #1# *@
@* $1$     @if (Model?.Post != null) #1# *@
@* $1$     { #1# *@
@* $1$         <div class="card tweet-card"> #1# *@
@* $1$             <div class="card-body"> #1# *@
@* $1$                 <div class="tweet-header"> #1# *@
@* $1$                     <img src="https://via.placeholder.com/48" alt="User Avatar" class="user-avatar"> #1# *@
@* $1$                     <div> #1# *@
@* $1$                         <span class="user-name">@Model.Post.User?.UserName</span> #1# *@
@* $1$                         <span class="tweet-timestamp">@Model.Post.PublishDate.ToString("MMM dd")</span> #1# *@
@* $1$                     </div> #1# *@
@* $1$                 </div> #1# *@
@* $1$                 <div class="tweet-content mt-3"> #1# *@
@* $1$                     <h5>@Model.Post.Title</h5> #1# *@
@* $1$                     <p>@Model.Post.Content</p> #1# *@
@* $1$                     @if (@Model.Post.Images != null && @Model.Post.Images.Any()) #1# *@
@* $1$                     { #1# *@
@* $1$                     <div id="postCarousel-@Model.Post.Id" class="carousel slide" data-ride="carousel"> #1# *@
@* $1$                         <div class="carousel-inner"> #1# *@
@* $1$                             @for (int i = 0; i < @Model.Post.Images.Count; i++) #1# *@
@* $1$                             { #1# *@
@* $1$                             <div class="carousel-item @(i == 0 ? "active" : "")"> #1# *@
@* $1$                                 <img src="@Url.Content($"/uploads/postImages/{@Model.Post.Images[i]}")" alt="Post Image" class="d-block"> #1# *@
@* $1$                             </div> #1# *@
@* $1$                             } #1# *@
@* $1$                         </div> #1# *@
@* $1$                         @if (@Model.Post.Images.Count > 1) #1# *@
@* $1$                         { #1# *@
@* $1$                         <a class="carousel-control-prev" href="#postCarousel-@Model.Post.Id" role="button" data-slide="prev"> #1# *@
@* $1$                             <span class="carousel-control-prev-icon" aria-hidden="true"></span> #1# *@
@* $1$                             <span class="sr-only">Previous</span> #1# *@
@* $1$                         </a> #1# *@
@* $1$                         <a class="carousel-control-next" href="#postCarousel-@Model.Post.Id" role="button" data-slide="next"> #1# *@
@* $1$                             <span class="carousel-control-next-icon" aria-hidden="true"></span> #1# *@
@* $1$                             <span class="sr-only">Next</span> #1# *@
@* $1$                         </a> #1# *@
@* $1$                         } #1# *@
@* $1$                     </div> #1# *@
@* $1$                     } #1# *@
@* $1$                 </div> #1# *@
@* $1$                 <div class="tweet-stats mt-3"> #1# *@
@* $1$                     <span title="Views"><i class="far fa-eye"></i> @Model.Post.Views</span> #1# *@
@* $1$                     <span title="Likes"><i class="far fa-heart"></i> @Model.Post.LikeCount</span> #1# *@
@* $1$                     <span title="Replies"><i class="far fa-comment"></i> @(Model.Replies?.Count() ?? 0)</span> #1# *@
@* $1$                 </div> #1# *@
@* $1$                 <!-- Add tweet actions here (like, bookmark, etc.) --> #1# *@
@* $1$             </div> #1# *@
@* $1$         </div> #1# *@
@* $1$ #1# *@
@* $1$         <div class="card mt-4"> #1# *@
@* $1$             <div class="card-body"> #1# *@
@* $1$                 <h5 class="card-title">Reply to this tweet</h5> #1# *@
@* $1$                 @if (User.Identity.IsAuthenticated) #1# *@
@* $1$                 { #1# *@
@* $1$                     <form asp-action="CreateReply" asp-route-postId="@Model.Post.Id" method="post"> #1# *@
@* $1$                         <div class="form-group"> #1# *@
@* $1$                             <textarea name="content" class="form-control" rows="3" required placeholder="Write your reply..."></textarea> #1# *@
@* $1$                         </div> #1# *@
@* $1$                         <button type="submit" class="btn btn-primary">Reply</button> #1# *@
@* $1$                     </form> #1# *@
@* $1$                 } #1# *@
@* $1$                 else #1# *@
@* $1$                 { #1# *@
@* $1$                     <p>Please <a asp-area="Identity" asp-page="/Account/Login">log in</a> to reply.</p> #1# *@
@* $1$                 } #1# *@
@* $1$             </div> #1# *@
@* $1$         </div> #1# *@
@* $1$ #1# *@
@* $1$         <h5 class="mt-4">Replies</h5> #1# *@
@* $1$         @if (Model.Replies != null && Model.Replies.Any()) #1# *@
@* $1$         { #1# *@
@* $1$             foreach (var reply in Model.Replies.OrderByDescending(r => r.CreatedAt)) #1# *@
@* $1$             { #1# *@
@* $1$                 <div class="card tweet-card mt-2"> #1# *@
@* $1$                     <div class="card-body"> #1# *@
@* $1$                         <div class="tweet-header"> #1# *@
@* $1$                             <img src="https://via.placeholder.com/32" alt="User Avatar" class="user-avatar-small"> #1# *@
@* $1$                             <div> #1# *@
@* $1$                                 <span class="user-name">@reply.User?.UserName</span> #1# *@
@* $1$                                 <span class="tweet-timestamp">@reply.CreatedAt.ToString("MMM dd")</span> #1# *@
@* $1$                             </div> #1# *@
@* $1$                         </div> #1# *@
@* $1$                         <div class="tweet-content mt-2"> #1# *@
@* $1$                             <p>@reply.Content</p> #1# *@
@* $1$                         </div> #1# *@
@* $1$                     </div> #1# *@
@* $1$                 </div> #1# *@
@* $1$             } #1# *@
@* $1$         } #1# *@
@* $1$         else #1# *@
@* $1$         { #1# *@
@* $1$             <p>No replies yet.</p> #1# *@
@* $1$         } #1# *@
@* $1$     } #1# *@
@* $1$     else #1# *@
@* $1$     { #1# *@
@* $1$         <p>Tweet not found.</p> #1# *@
@* $1$     } #1# *@
@* $1$ </div> #1# *@
@* *@
@* *@
@* *@
@* *@
@* @using AlbBlogger1.Data *@
@* @using Microsoft.AspNetCore.Identity *@
@* @using Microsoft.AspNetCore.Mvc.TagHelpers *@
@* @model PostDetailsViewModel *@
@* @inject UserManager<ApplicationUser> UserManager *@
@* *@
@* @{ *@
@*     ViewData["Title"] = "Details"; *@
@* } *@
@* *@
@* <div class="container mt-4"> *@
@*     @if (Model?.Post != null) *@
@*     { *@
@*         <div class="card tweet-card"> *@
@*             <div class="card-body"> *@
@*                 <div class="tweet-header"> *@
@*                     <img src="https://via.placeholder.com/48" alt="User Avatar" class="user-avatar"> *@
@*                     <div> *@
@*                         <span class="user-name">@Model.Post.User?.UserName</span> *@
@*                         <span class="tweet-timestamp">@Model.Post.PublishDate.ToString("MMM dd")</span> *@
@*                     </div> *@
@*                 </div> *@
@*                 <div class="tweet-content mt-3"> *@
@*                     <h5>@Model.Post.Title</h5> *@
@*                     <p>@Model.Post.Content</p> *@
@*                     @if (@Model.Post.Images != null && @Model.Post.Images.Any()) *@
@*                     { *@
@*                         <div id="postCarousel-@Model.Post.Id" class="carousel slide" data-ride="carousel"> *@
@*                             <div class="carousel-inner"> *@
@*                                 @for (int i = 0; i < @Model.Post.Images.Count; i++) *@
@*                                 { *@
@*                                     <div class="carousel-item @(i == 0 ? "active" : "")"> *@
@*                                         <img src="@Url.Content($"/uploads/postImages/{@Model.Post.Images[i]}")" alt="Post Image" class="d-block"> *@
@*                                     </div> *@
@*                                 } *@
@*                             </div> *@
@*                             @if (@Model.Post.Images.Count > 1) *@
@*                             { *@
@*                                 <a class="carousel-control-prev" href="#postCarousel-@Model.Post.Id" role="button" data-slide="prev"> *@
@*                                     <span class="carousel-control-prev-icon" aria-hidden="true"></span> *@
@*                                     <span class="sr-only">Previous</span> *@
@*                                 </a> *@
@*                                 <a class="carousel-control-next" href="#postCarousel-@Model.Post.Id" role="button" data-slide="next"> *@
@*                                     <span class="carousel-control-next-icon" aria-hidden="true"></span> *@
@*                                     <span class="sr-only">Next</span> *@
@*                                 </a> *@
@*                             } *@
@*                         </div> *@
@*                     } *@
@*                 </div> *@
@*                 <div class="tweet-stats mt-3"> *@
@*                     <span title="Views"><i class="far fa-eye"></i> @Model.Post.Views</span> *@
@*                     <span title="Likes"><i class="far fa-heart"></i> @Model.Post.LikeCount</span> *@
@*                     <span title="Replies"><i class="far fa-comment"></i> @(Model.Replies?.Count() ?? 0)</span> *@
@*                 </div> *@
@*                 <!-- Add tweet actions here (like, bookmark, etc.) --> *@
@*             </div> *@
@*         </div> *@
@* *@
@*         <div class="card mt-4"> *@
@*             <div class="card-body"> *@
@*                 <h5 class="card-title">Reply to this tweet</h5> *@
@*                 @if (User.Identity.IsAuthenticated) *@
@*                 { *@
@*                     <form asp-action="CreateReply" asp-route-postId="@Model.Post.Id" method="post"> *@
@*                         <div class="form-group"> *@
@*                             <textarea name="content" class="form-control" rows="3" required placeholder="Write your reply..."></textarea> *@
@*                         </div> *@
@*                         <button type="submit" class="btn btn-primary">Reply</button> *@
@*                     </form> *@
@*                 } *@
@*                 else *@
@*                 { *@
@*                     <p>Please <a asp-area="Identity" asp-page="/Account/Login">log in</a> to reply.</p> *@
@*                 } *@
@*             </div> *@
@*         </div> *@
@* *@
@*         <h5 class="mt-4">Replies</h5> *@
@*         @if (Model.Replies != null && Model.Replies.Any()) *@
@*         { *@
@*             @await Html.PartialAsync("_RepliesPartial", Model.Replies.Where(r => r.ParentReplyId == null).OrderByDescending(r => r.CreatedAt).ToList()) *@
@*         } *@
@*         else *@
@*         { *@
@*             <p>No replies yet.</p> *@
@*         } *@
@*     } *@
@*     else *@
@*     { *@
@*         <p>Tweet not found.</p> *@
@*     } *@
@* </div> *@
@* *@
@* @section Scripts { *@
@*     <script> *@
@*         function toggleReplyForm(replyId) { *@
@*             var form = document.getElementById('replyForm' + replyId); *@
@*             form.style.display = form.style.display === 'none' ? 'block' : 'none'; *@
@*         } *@
@*     </script> *@
@* } *@

@* *@
@* @using AlbBlogger1.Data *@
@* @using Microsoft.AspNetCore.Identity *@
@* @using Microsoft.AspNetCore.Mvc.TagHelpers *@
@* @model PostDetailsViewModel *@
@* @inject UserManager<ApplicationUser> UserManager *@
@* *@
@* @{ *@
@*     ViewData["Title"] = "Details"; *@
@* } *@
@* *@
@* <div class="container mt-4"> *@
@*     @if (Model?.Post != null) *@
@*     { *@
@*         <div class="card tweet-card"> *@
@*             <div class="card-body"> *@
@*                 <div class="tweet-header"> *@
@*                     <img src="https://via.placeholder.com/48" alt="User Avatar" class="user-avatar"> *@
@*                     <div> *@
@*                         <span class="user-name">@Model.Post.User?.UserName</span> *@
@*                         <span class="tweet-timestamp">@Model.Post.PublishDate.ToString("MMM dd")</span> *@
@*                     </div> *@
@*                 </div> *@
@*                 $1$ <div class="tweet-content mt-3"> #1# *@
@*                 $1$     <h5>@Model.Post.Title</h5> #1# *@
@*                 $1$     <p>@Model.Post.Content</p> #1# *@
@*                 $1$     @if (Model.Post.Images != null && Model.Post.Images.Any()) #1# *@
@*                 $1$     { #1# *@
@*                 $1$         <div id="postCarousel-@Model.Post.Id" class="carousel slide" data-ride="carousel"> #1# *@
@*                 $1$             <div class="carousel-inner"> #1# *@
@*                 $1$                 @for (int i = 0; i < Model.Post.Images.Count; i++) #1# *@
@*                 $1$                 { #1# *@
@*                 $1$                     <div class="carousel-item @(i == 0 ? "active" : "")"> #1# *@
@*                 $1$                         <img src="@Url.Content($"/uploads/postImages/{Model.Post.Images[i]}")" alt="Post Image" class="d-block"> #1# *@
@*                 $1$                     </div> #1# *@
@*                 $1$                 } #1# *@
@*                 $1$             </div> #1# *@
@*                 $1$             @if (Model.Post.Images.Count > 1) #1# *@
@*                 $1$             { #1# *@
@*                 $1$                 <a class="carousel-control-prev" href="#postCarousel-@Model.Post.Id" role="button" data-slide="prev"> #1# *@
@*                 $1$                     <span class="carousel-control-prev-icon" aria-hidden="true"></span> #1# *@
@*                 $1$                     <span class="sr-only">Previous</span> #1# *@
@*                 $1$                 </a> #1# *@
@*                 $1$                 <a class="carousel-control-next" href="#postCarousel-@Model.Post.Id" role="button" data-slide="next"> #1# *@
@*                 $1$                     <span class="carousel-control-next-icon" aria-hidden="true"></span> #1# *@
@*                 $1$                     <span class="sr-only">Next</span> #1# *@
@*                 $1$                 </a> #1# *@
@*                 $1$             } #1# *@
@*                 $1$         </div> #1# *@
@*                 $1$     } #1# *@
@*                 $1$ </div> #1# *@
@* *@
@*                 <div class="tweet-content mt-3"> *@
@*                     <h5>@Model.Post.Title</h5> *@
@*                     <p>@Model.Post.Content</p> *@
@*                     @if (Model.Post.Images != null && Model.Post.Images.Any()) *@
@*                     { *@
@*                     <div class="tweet-images @($"tweet-images-{Model.Post.Images.Count}")"> *@
@*                         @for (int i = 0; i < Model.Post.Images.Count; i++) *@
@*                         { *@
@*                         <div class="tweet-image-container"> *@
@*                             <img src="@Url.Content($"/uploads/postImages/{Model.Post.Images[i]}")" alt="Post Image" class="tweet-image"> *@
@*                         </div> *@
@*                         } *@
@*                     </div> *@
@*                     } *@
@*                 </div> *@
@*                  *@
@*                 <div class="tweet-stats mt-3"> *@
@*                     <span title="Views"><i class="far fa-eye"></i> @Model.Post.Views</span> *@
@*                     <span title="Likes"><i class="far fa-heart"></i> @Model.Post.LikeCount</span> *@
@*                     <span title="Replies"><i class="far fa-comment"></i> @(Model.Replies?.Count() ?? 0)</span> *@
@*                 </div> *@
@*                 <!-- Add tweet actions here (like, bookmark, etc.) --> *@
@*             </div> *@
@*         </div> *@
@* *@
@*         <div class="card mt-4"> *@
@*             <div class="card-body"> *@
@*                 <h5 class="card-title">Reply to this tweet</h5> *@
@*                 @if (User.Identity.IsAuthenticated) *@
@*                 { *@
@*                     <form asp-action="CreateReply" asp-route-postId="@Model.Post.Id" method="post"> *@
@*                         <div class="form-group"> *@
@*                             <textarea name="content" class="form-control" rows="3" required placeholder="Write your reply..."></textarea> *@
@*                         </div> *@
@*                         <button type="submit" class="btn btn-primary">Reply</button> *@
@*                     </form> *@
@*                 } *@
@*                 else *@
@*                 { *@
@*                     <p>Please <a asp-area="Identity" asp-page="/Account/Login">log in</a> to reply.</p> *@
@*                 } *@
@*             </div> *@
@*         </div> *@
@* *@
@*         <h5 class="mt-4">Replies</h5> *@
@*         @if (Model.Replies != null && Model.Replies.Any()) *@
@*         { *@
@*             @await Html.PartialAsync("_RepliesPartial", Model.Replies.Where(r => r.ParentReplyId == null).OrderByDescending(r => r.CreatedAt).ToList()) *@
@*         } *@
@*         else *@
@*         { *@
@*             <p>No replies yet.</p> *@
@*         } *@
@*     } *@
@*     else *@
@*     { *@
@*         <p>Tweet not found.</p> *@
@*     } *@
@* </div> *@
@* $1$ #1# *@
@* $1$ @section Scripts { #1# *@
@* $1$     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> #1# *@
@* $1$     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> #1# *@
@* $1$     <script> #1# *@
@* $1$         function toggleReplyForm(replyId) { #1# *@
@* $1$             var form = document.getElementById('replyForm' + replyId); #1# *@
@* $1$             form.style.display = form.style.display === 'none' ? 'block' : 'none'; #1# *@
@* $1$         } #1# *@
@* $1$     </script> #1# *@
@* $1$      #1# *@
@* $1$     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> #1# *@
@* $1$     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> #1# *@
@* $1$     <script> #1# *@
@* $1$         function toggleReplyForm(replyId) { #1# *@
@* $1$             var form = document.getElementById('replyForm' + replyId); #1# *@
@* $1$             form.style.display = form.style.display === 'none' ? 'block' : 'none'; #1# *@
@* $1$         } #1# *@
@* $1$ #1# *@
@* $1$         function toggleChildReplies(replyId) { #1# *@
@* $1$             var childReplies = document.getElementById('childReplies-' + replyId); #1# *@
@* $1$             var button = event.target; #1# *@
@* $1$             if (childReplies.style.display === 'none') { #1# *@
@* $1$                 childReplies.style.display = 'block'; #1# *@
@* $1$                 button.textContent = 'Hide Replies (' + $('#childReplyCount-' + replyId).text() + ')'; #1# *@
@* $1$             } else { #1# *@
@* $1$                 childReplies.style.display = 'none'; #1# *@
@* $1$                 button.textContent = 'Show Replies (' + $('#childReplyCount-' + replyId).text() + ')'; #1# *@
@* $1$             } #1# *@
@* $1$         } #1# *@
@* $1$     </script> #1# *@
@* $1$ #1# *@
@* $1$      #1# *@
@* $1$ } #1# *@

@using AlbBlogger1.Data
@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model PostDetailsViewModel
@inject UserManager<ApplicationUser> UserManager

@{
ViewData["Title"] = "Details";
}

<div class="container mt-4">
    @if (Model?.Post != null)
    {
    <div class="card tweet-card">
        <div class="card-body">
            <div class="tweet-header">
                <img src="https://via.placeholder.com/48" alt="User Avatar" class="user-avatar">
                <div>
                    <span class="user-name">@Model.Post.User?.UserName</span>
                    <span class="tweet-timestamp">@Model.Post.PublishDate.ToString("MMM dd")</span>
                </div>
            </div>
            <div class="tweet-content mt-3">
                <h5>@Model.Post.Title</h5>
                <p>@Model.Post.Content</p>
                @if (Model.Post.Images != null && Model.Post.Images.Any())
                {
                <div id="postCarousel-@Model.Post.Id" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        @for (int i = 0; i < Model.Post.Images.Count; i++)
                        {
                        <div class="carousel-item @(i == 0 ? "active" : "")">
                            <img src="@Url.Content($"/uploads/postImages/{Model.Post.Images[i]}")" alt="Post Image" class="d-block">
                        </div>
                        }
                    </div>
                    @if (Model.Post.Images.Count > 1)
                    {
                    <a class="carousel-control-prev" href="#postCarousel-@Model.Post.Id" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#postCarousel-@Model.Post.Id" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                    }
                </div>
                }
            </div>
            <div class="tweet-stats mt-3">
                <span title="Views"><i class="far fa-eye"></i> @Model.Post.Views</span>
                <span title="Likes"><i class="far fa-heart"></i> @Model.Post.LikeCount</span>
                <span title="Replies"><i class="far fa-comment"></i> @(Model.Replies?.Count() ?? 0)</span>
            </div>
            <!-- Add tweet actions here (like, bookmark, etc.) -->
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-body">
            <h5 class="card-title">Reply to this tweet</h5>
            @if (User.Identity.IsAuthenticated)
            {
            <form asp-action="CreateReply" asp-route-postId="@Model.Post.Id" method="post">
                <div class="form-group">
                    <textarea name="content" class="form-control" rows="3" required placeholder="Write your reply..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Reply</button>
            </form>
            }
            else
            {
            <p>Please <a asp-area="Identity" asp-page="/Account/Login">log in</a> to reply.</p>
            }
        </div>
    </div>

    <h5 class="mt-4">Replies</h5>
    @if (Model.Replies != null && Model.Replies.Any())
    {
    @await Html.PartialAsync("_RepliesPartial", Model.Replies.Where(r => r.ParentReplyId == null).OrderByDescending(r => r.CreatedAt).ToList())
    }
    else
    {
    <p>No replies yet.</p>
    }
    }
    else
    {
    <p>Tweet not found.</p>
    }
</div>


@section Scripts {
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    function toggleReplyForm(replyId) {
        $('#replyForm' + replyId).toggle();
    }

    function toggleChildReplies(replyId) {
        var $childReplies = $('#childReplies-' + replyId);
        var $button = $('[onclick="toggleChildReplies(' + replyId + ')"]');
        if ($childReplies.is(':visible')) {
            $childReplies.hide();
            $button.html('<i class="fas fa-chevron-down"></i> Show Replies (' + $('#childReplyCount-' + replyId).text() + ')');
        } else {
            $childReplies.show();
            $button.html('<i class="fas fa-chevron-up"></i> Hide Replies (' + $('#childReplyCount-' + replyId).text() + ')');
        }
    }

    function submitReply(event, parentReplyId, postId) {
        event.preventDefault();
        var form = event.target;
        var content = form.querySelector('textarea[name="content"]').value;

        $.ajax({
            url: '@Url.Action("CreateReplyForReply", "Post")',
            type: 'POST',
            data: { parentReplyId: parentReplyId, postId: postId, content: content },
            success: function(response) {
                if (response.success) {
                    // Append the new reply to the list
                    var newReplyHtml = `
                            <div class="tweet-card mt-2" id="reply-${response.replyId}">
                                <div class="tweet-content">
                                    <div class="tweet-header">
                                        <img src="https://via.placeholder.com/32" alt="User Avatar" class="user-avatar-small">
                                        <div>
                                            <span class="user-name">${response.userName}</span>
                                            <span class="tweet-timestamp">Just now</span>
                                        </div>
                                    </div>
                                    <p>${response.content}</p>
                                </div>
                                <div class="tweet-actions">
                                    <button class="btn btn-sm btn-link" onclick="toggleReplyForm(${response.replyId})">
                                        <i class="far fa-comment"></i> Reply
                                    </button>
                                </div>
                                <div id="replyForm${response.replyId}" style="display: none;" class="mt-2">
                                    <!-- Reply form here -->
                                </div>
                            </div>
                        `;

                    var $parentReply = $('#reply-' + parentReplyId);
                    var $childReplies = $('#childReplies-' + parentReplyId);

                    if ($childReplies.length === 0) {
                        $childReplies = $('<div id="childReplies-' + parentReplyId + '" class="ml-4 mt-2"></div>');
                        $parentReply.append($childReplies);

                        // Add "Show Replies" button
                        var showRepliesButton = `
                                <button class="btn btn-sm btn-link" onclick="toggleChildReplies(${parentReplyId})">
                                    <i class="fas fa-chevron-down"></i> Show Replies (<span id="childReplyCount-${parentReplyId}">1</span>)
                                </button>
                            `;
                        $parentReply.find('.tweet-actions').append(showRepliesButton);
                    } else {
                        var currentCount = parseInt($('#childReplyCount-' + parentReplyId).text());
                        $('#childReplyCount-' + parentReplyId).text(currentCount + 1);
                    }

                    $childReplies.prepend(newReplyHtml);
                    $childReplies.show();

                    // Clear the form
                    form.reset();
                    toggleReplyForm(parentReplyId);
                } else {
                    alert(response.message);
                }
            },
            error: function() {
                alert("An error occurred while processing your request.");
            }
        });
    }
</script>
}


<style>
    /*.carousel-inner img {*/
    /*    width: 100%;*/
    /*    height: auto; !* Ensure the image keeps its aspect ratio *!*/
    /*}*/
    /*.carousel-control-prev-icon, .carousel-control-next-icon {*/
    /*    background-color: rgba(0, 0, 0, 0.5); !* Slightly visible background for controls *!*/
    /*    border-radius: 50%; !* Rounded controls *!*/
    /*}*/
    .tweet-card {
        border: 1px solid #e1e8ed;
        border-radius: 12px;
        padding: 12px;
        margin-bottom: 12px;
        background-color: white;
    }

    .tweet-header {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
    }

    .user-avatar-small {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        margin-right: 12px;
    }

    .user-name {
        font-weight: bold;
        margin-right: 4px;
    }

    .tweet-timestamp {
        color: #657786;
        font-size: 0.9em;
    }

    .tweet-content p {
        margin-bottom: 12px;
    }

    .tweet-actions {
        display: flex;
        justify-content: flex-start;
        color: #657786;
    }

    .tweet-actions button {
        color: #657786;
        margin-right: 16px;
    }

    .tweet-actions button:hover {
        color: #1da1f2;
    }
    
</style>

